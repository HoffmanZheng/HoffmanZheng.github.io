<!DOCTYPE html>
<html lang="en-us">
  <head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noodp"/>
  <meta name="author" content="Chenghao.Zheng">
  
  
  
  <link rel="prev" href="http://chenghao.monster/2019/git/" />
  <link rel="next" href="http://chenghao.monster/2020/java-collection/" />
  <link rel="canonical" href="http://chenghao.monster/2019/maven-plugin-package-management/" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  <title>
       
       
           Maven：生命周期、插件及包管理 | 人间一场大梦
       
  </title>
  <meta name="title" content="Maven：生命周期、插件及包管理 | 人间一场大梦">
    
  
  <link rel="stylesheet" href="/font/iconfont.css">
  <link rel="stylesheet" href="/css/main.min.css">


  
  
 

<script type="application/ld+json">
 "@context" : "http://schema.org",
    "@type" : "BlogPosting",
    "mainEntityOfPage": {
         "@type": "WebPage",
         "@id": "http:\/\/chenghao.monster"
    },
    "articleSection" : "posts",
    "name" : "Maven：生命周期、插件及包管理",
    "headline" : "Maven：生命周期、插件及包管理",
    "description" : "Maven 作为一个强大的项目管理工具，在项目清理、开发、部署时有着强大的功能。此外，Maven 还可以自动管理 Java 包的传递性依赖，解决包的依赖冲突并对依赖的 scope 进行控制。 本篇对其功能和用法做简单的介绍。\nMaven 的生命周期 1. Maven 简介 Maven 是一个项目管理工具，它包含了一个项目对象模型（Project Object Model），反映在配置中，就是一个 pom.xml 文件。是一组标准集合，一个项目的生命周期、一个包依赖管理系统。\n当我们使用 Maven 的时候，通过一个自定义的项目对象模型，pom.xml 来详细描述我们自己的项目。\n2. Maven 的生命周期 Maven 有三个内置的构建生命周期：default生命周期处理你的项目开发，clean 生命周期负责清理，而 site  生命周期处理项目站点文档的创建。\n具体的生命周期及其顺序可参见 Apache Maven 官方生命周期文档，在我们使用命令调动生命周期的时候，比如 mvn verify，它会按照顺序执行 verify 之前的每个默认的生命周期阶段。\n3. Maven 中的插件 Maven 实际上只是 Maven 插件集合的核心框架。插件是大多数操作实际执行的地方，几乎可以想到的对项目的所有操作都是由 Maven 插件来执行的。\nMaven 在某个生命周期中执行的职责与该阶段绑定的插件目标 plugin : goal 有关，插件的 goal 代表一个特定的任务。当 maven 的生命周期运行到插件所绑定的阶段时，便会运行该阶段内所声明的插件任务。\n插件的配置可以参考 Apache Maven 官方插件配置指南，下图以 spotbugs 插件为例图示插件在 pom.xml 文件中的配置。\nMaven 下的 Java 包管理 1.",
    "inLanguage" : "en-us",
    "author" : "Chenghao Zheng",
    "creator" : "Chenghao Zheng",
    "publisher": "Chenghao Zheng",
    "accountablePerson" : "Chenghao Zheng",
    "copyrightHolder" : "Chenghao Zheng",
    "copyrightYear" : "2019",
    "datePublished": "2019-12-29 23:37:47 \x2b0100 CET",
    "dateModified" : "2019-12-29 23:37:47 \x2b0100 CET",
    "url" : "http:\/\/chenghao.monster\/2019\/maven-plugin-package-management\/",
    "wordCount" : "222",
    "keywords" : [ "Tools", "人间一场大梦"]
}
</script>

</head>

  


  <body class="">
    <div class="wrapper">
        <nav class="navbar">
    
        <div class="top-scroll-bar"></div>
    
    <div class="container">
        <div class="navbar-header header-logo">
        	<a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href="http://chenghao.monster">人间一场大梦</a>
        </div>
        <div class="menu navbar-right">
                
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="/tags/" title="">Tags</a>
                
                <a class="menu-item" href="/about/" title="">About</a>
                
        </div>
    </div>
</nav>
<nav class="navbar-mobile" id="nav-mobile" style="display: none">
    
        <div class="top-scroll-bar"></div>
    
     <div class="container">
        <div class="navbar-header">
            <div>  <a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href="http://chenghao.monster">人间一场大梦</a></div>
            <div class="menu-toggle">
                <span></span><span></span><span></span>
            </div>
        </div>
     
          <div class="menu" id="mobile-menu">
                
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="/tags/" title="">Tags</a>
                
                <a class="menu-item" href="/about/" title="">About</a>
                
        </div>
    </div>
</nav>
    	 <main class="main">
          <div class="container">
      		
<article class="post-warp" itemscope itemtype="http://schema.org/Article">
    <header class="post-header">
        <h1 class="post-title" itemprop="name headline">Maven：生命周期、插件及包管理</h1>
        <div class="post-meta">
                Written by <a itemprop="name" href="http://chenghao.monster" rel="author">Chenghao Zheng</a> with ♥ 
                <span class="post-time">
                on <time datetime=2019-12-29 itemprop="datePublished">December 29, 2019</time>
                </span>
                in
                <i class="iconfont icon-folder"></i>
                <span class="post-category">
                        <a href="http://chenghao.monster/categories/study-notes/"> Study notes </a>
                        
                </span>
                 <span class="post-word-count">,222 words</span>
        </div>
    </header>
    <div class="post-content">
        

        
            
        

        
        
     
          
          
          

          
          
          

          <p>Maven 作为一个强大的项目管理工具，在项目清理、开发、部署时有着强大的功能。此外，Maven 还可以自动管理 Java 包的传递性依赖，解决包的依赖冲突并对依赖的 scope 进行控制。 本篇对其功能和用法做简单的介绍。</p>
<h1 id="maven-的生命周期">Maven 的生命周期</h1>
<h3 id="1-maven-简介">1. Maven 简介</h3>
<p>Maven 是一个项目管理工具，它包含了一个项目对象模型（Project Object Model），反映在配置中，就是一个 <code>pom.xml</code> 文件。是一组标准集合，一个项目的生命周期、一个包依赖管理系统。</p>
<p>当我们使用 Maven 的时候，通过一个自定义的项目对象模型，pom.xml 来详细描述我们自己的项目。</p>
<h3 id="2-maven-的生命周期">2. Maven 的生命周期</h3>
<p>Maven 有三个内置的构建生命周期：<code>default</code>生命周期处理你的项目开发，<code>clean</code> 生命周期负责清理，而 <code>site </code> 生命周期处理项目站点文档的创建。</p>
<p><img src="/images/maven%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F.png" alt=""></p>
<p>具体的生命周期及其顺序可参见 <a href="https://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html#Build_Lifecycle_Basics">Apache Maven 官方生命周期文档</a>，在我们使用命令调动生命周期的时候，比如 <code>mvn verify</code>，它会按照顺序执行 verify 之前的每个默认的生命周期阶段。</p>
<h3 id="3-maven-中的插件">3. Maven 中的插件</h3>
<p>Maven 实际上只是 Maven 插件集合的核心框架。插件是大多数操作实际执行的地方，几乎可以想到的对项目的所有操作都是由 Maven 插件来执行的。</p>
<p>Maven 在某个生命周期中执行的职责与该阶段绑定的插件目标 <code>plugin : goal</code> 有关，插件的 goal 代表一个特定的任务。当 maven 的生命周期运行到插件所绑定的阶段时，便会运行该阶段内所声明的插件任务。</p>
<p>插件的配置可以参考 <a href="https://maven.apache.org/guides/mini/guide-configuring-plugins.html">Apache Maven 官方插件配置指南</a>，下图以 <code>spotbugs</code> 插件为例图示插件在 pom.xml 文件中的配置。</p>
<p><img src="/images/maven%E6%8F%92%E4%BB%B6.png" alt="">　</p>
<h1 id="maven-下的-java-包管理">Maven 下的 Java 包管理</h1>
<h3 id="1-包管理的必要性">1. 包管理的必要性</h3>
<ul>
<li>JVM 的作用就是执行一个类的字节码，当它需要加载一个新的类时，就会去 <code>Classpath</code> 中寻找这个类。包的 <code>全限定类名</code> 是包的唯一标识，当 Classpath 中出现（不同版本的）同名包时，JVM 会选择 Classpath 中出现最早的包 进行加载。</li>
<li>包的调用存在传递性依赖，即你所调用的包同时还调用了其他别的包，这会导致一个项目的实现需要调用相当数量的第三方包，使包的管理与更新成了一个很大的难题。（同时也使自己的代码在别人的机器上不能正常的运行）</li>
</ul>
<h3 id="2-maven包管理工具">2. Maven：包管理工具</h3>
<h4 id="21-包的约定与语义化版本">2.1 包的约定与语义化版本</h4>
<ul>
<li>Maven 收录了几乎所有的 Java 包保存在其远程的 <a href="http://repo1.maven.org/maven2/">中央仓库</a>，并对包的 ID 给出了三个约定，分别为 <code>Groupid、Artifactid、version</code> ，用结构化的方式，把包分门别类的放到一起，实现了方便检索的目的。</li>
<li>同时，包的版本号受到了<a href="https://semver.org/lang/zh-CN/"> 语义化版本控制规范 </a></li>
</ul>
<h4 id="22-自动化包管理">2.2 自动化包管理</h4>
<ul>
<li>当在 <code>pom.xml</code> 中引入一个第三方包的时候，Maven 就知道去哪里下载了，并且把它的传递性依赖也同时下载至本地 <code>~\.m2</code>。你可以删除该文件夹中的包，但在 <code>maven 刷新</code> 后，maven 会为你自动下载所需要的包，这也方便了在他人机器上跑自己的代码，或是在团队项目中便捷地管理所需要的包。</li>
<li>Maven 为包提供了三种 Scope：
<ul>
<li>compile、test、及 provided（只在编译有效，运行无效，适合运行时由他人提供 jar 包的场景）</li>
</ul>
</li>
</ul>
<h3 id="3-maven包的冲突与解决">3. Maven：包的冲突与解决</h3>
<h4 id="31-包的冲突">3.1 包的冲突</h4>
<ul>
<li>当项目的不同位置调用了 <code>不同版本</code> 的某个类库时，就可能会发生包的冲突。因为 JVM 会自动调用在 Classpath 中出现的早的那个版本类库，导致运行时调用了错误版本的类库产生错误，同时我们也不能很好的去管理调用类库的版本。</li>
<li>常见的包冲突异常有：
<ul>
<li>NoSuchMethodError - AbstractMethodError - NoClassDefFoundError - ClassNotFoundError - LinkageError 等。</li>
</ul>
</li>
</ul>
<h4 id="32-maven-依赖树">3.2 Maven 依赖树</h4>
<ul>
<li>
<p>Maven 中有三种查看包的依赖树的方法：</p>
<ul>
<li>IDE 右侧 Maven &mdash;&gt; Dependencies</li>
<li>Terminal &mdash; <code>mvn dependency:tree</code> （这里可以重定向到文件，方便查看）</li>
<li>安装 <code>Maven helper</code> 插件 &mdash;&gt; IDE 中查看 <code>pom.xml</code> 文件，点击下方 <code>Dependency Analyzer</code> 可以查看调用包的依赖树，并且可以直观的看到树中存在的包冲突，非常实用。</li>
</ul>
</li>
<li>
<p>Maven 调用包的原则</p>
<ul>
<li>
<p>绝对不允许最终的 <code>classpath</code> 出现同名不同版本的类库</p>
</li>
<li>
<p>依赖冲突的解决：离你项目最近的胜出（Maven 不分析版本号，只依赖这个原则）</p>
<ul>
<li>相比之下，Gradle 则是选择的最高版本的类库。</li>
<li>实际上，都需要人工介入选择项目需要调用的版本。</li>
</ul>
</li>
<li>
<p>离的一样近的情况：在 <code>classpath</code> 中先出现的胜出 （靠前声明）</p>
</li>
</ul>
</li>
</ul>
<h4 id="33-包冲突的解决办法">3.3 包冲突的解决办法</h4>
<ul>
<li>为项目选择版本合适的类库：
<ul>
<li>可以去 <code>Github - branch</code> 右侧选择 <code>Tags</code> 看不同版本的类库源代码之间的区别，为项目选择合适的版本。（特别废精力）</li>
</ul>
</li>
<li>解决冲突：
<ul>
<li>Maven 会选择离你项目最近的依赖包（的版本）进行调用（不分析版本号） &mdash;&gt; 把想要调用的版本类库引入到和项目近的地方。</li>
<li>在 <code>pom.xml</code> 对应类库下 手写 <code>exclusions</code> ，把冲突包干掉。</li>
<li>在 <code>Maven helper</code> 中，选择不想要调用的类库，右击 <code>Exclude</code> 就可以了。</li>
</ul>
</li>
</ul>
<h3 id="4-推荐阅读">4. 推荐阅读</h3>
<ul>
<li>书籍 《Maven 实战》
<ul>
<li>书籍有点老，阅读指南：</li>
<li>第五、六、七、八章为核心概念，必看。</li>
<li>第三、四章：入门和背景案例，可以了解下，代码过时不要抄。</li>
<li>第十章 第十二章：测试、web应用，可以瞄一眼。</li>
<li>第十三、十四章：版本管理、灵活的构建，可以看一下下。</li>
<li>第十七章：编写 Maven 插件，没有需要可以不看。</li>
</ul>
</li>
<li><a href="https://blindpirate.github.io/2019/05/10/Maven/"> 彰德老师的Maven讲解</a></li>
</ul>

    </div>

    <div class="post-copyright">
             
            <p class="copyright-item">
                <span>Author:</span>
                <span>Chenghao.Zheng </span>
                </p>
            
           
             
            <p class="copyright-item">
                    <span>Link:</span>
                    <a href=http://chenghao.monster/2019/maven-plugin-package-management/>http://chenghao.monster/2019/maven-plugin-package-management/</span>
            </p>
            
             
            <p class="copyright-item lincese">
                本文采用知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可
            </p>
            
    </div>

  
    <div class="post-tags">
        
            <section>
            <i class="iconfont icon-tag"></i>Tag(s): 
            
            <span class="tag"><a href="http://chenghao.monster/tags/tools/">
                    #Tools</a></span>
            
            </section>
        
        <section>
                <a href="javascript:window.history.back();">back</a></span> · 
                <span><a href="http://chenghao.monster">home</a></span>
        </section>
    </div>

    <div class="post-nav">
        
        <a href="http://chenghao.monster/2019/git/" class="prev" rel="prev" title="Git 与 Github 使用指北"><i class="iconfont icon-left"></i>&nbsp;Git 与 Github 使用指北</a>
         
        
        <a href="http://chenghao.monster/2020/java-collection/" class="next" rel="next" title="Java：Collection、Map 工具类及常见方法">Java：Collection、Map 工具类及常见方法&nbsp;<i class="iconfont icon-right"></i></a>
        
    </div>

    <div class="post-comment">
          
                 
          
    </div>
</article>
          </div>
		   </main>
      <footer class="footer">
    <div class="copyright">
        &copy;
        
        <span itemprop="copyrightYear">2019 - 2020</span>
        
        <span class="with-love">
    	 <i class="iconfont icon-love"></i> 
         </span>
         
            <span class="author" itemprop="copyrightHolder"><a href="http://chenghao.monster">Chenghao.Zheng</a> | </span> 
         

         
		  <span>Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow">Hugo</a> & <a href="https://github.com/liuzc/leaveit" target="_blank" rel="external nofollow">LeaveIt</a></span> 
    </div>
</footer>













    
     <link href="//lib.baomitu.com/lightgallery/1.6.11/css/lightgallery.min.css" rel="stylesheet">  
      
     <script src="/js/vendor_gallery.min.js" async="" ></script>
    
  



     </div>
  </body>
</html>
