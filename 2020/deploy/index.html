<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>Java：程序的部署和 Nginx 负载均衡 - 人间一场大梦</title><meta name="author" content="Chenghao Zheng">
<meta name="description" content="本篇介绍 Java 程序部署的三种方式：exec 插件、jar 包、Docker 方式部署，以及使用 Nginx 实现简单的负载均衡。
Java 程序的部署 Maven exec 插件部署 导入 Maven 的 exec 插件：Maven Repository：exec-maven-plugin，然后在 pom.xml 中进行配置，使之可以调用外部命令执行 Java 程序并自动加载依赖的 classpath 路径： &lt;plugin&gt; &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt; &lt;artifactId&gt;exec-maven-plugin&lt;/artifactId&gt; &lt;version&gt;1.6.0&lt;/version&gt; &lt;executions&gt; &lt;execution&gt; &lt;id&gt;run&lt;/id&gt; &lt;goals&gt; &lt;goal&gt;exec&lt;/goal&gt; &lt;/goals&gt; &lt;configuration&gt; &lt;executable&gt;java&lt;/executable&gt; &lt;arguments&gt; &lt;argument&gt;-classpath&lt;/argument&gt; &lt;!-- automatically creates the classpath using all project dependencies, also adding the project build directory --&gt; &lt;classpath/&gt; &lt;argument&gt;com.github.hoffmanzheng.springboot.Application&lt;/argument&gt; &lt;/arguments&gt; &lt;/configuration&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;/plugin&gt; mvn exec:exec@[executionID] 即可完成程序的部署；-X 参数可以用于排查部署时出现的问题，-DskipTests 可以跳过测试。 windosw下（需使用系统 cmd） netstat -ano | findstr &quot;8080&quot; 可以查看当前端口被占用的情况，tasklist |findstr &quot;进程id号&quot; 查找对应的进程名称，然后 taskkill /f /t /im &quot;进程id或者进程名称&quot; 杀掉当前占用端口的进程 部署效果图：
"><meta name="keywords" content='Java'>
  <meta itemprop="name" content="Java：程序的部署和 Nginx 负载均衡">
  <meta itemprop="description" content="本篇介绍 Java 程序部署的三种方式：exec 插件、jar 包、Docker 方式部署，以及使用 Nginx 实现简单的负载均衡。
Java 程序的部署 Maven exec 插件部署 导入 Maven 的 exec 插件：Maven Repository：exec-maven-plugin，然后在 pom.xml 中进行配置，使之可以调用外部命令执行 Java 程序并自动加载依赖的 classpath 路径： &lt;plugin&gt; &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt; &lt;artifactId&gt;exec-maven-plugin&lt;/artifactId&gt; &lt;version&gt;1.6.0&lt;/version&gt; &lt;executions&gt; &lt;execution&gt; &lt;id&gt;run&lt;/id&gt; &lt;goals&gt; &lt;goal&gt;exec&lt;/goal&gt; &lt;/goals&gt; &lt;configuration&gt; &lt;executable&gt;java&lt;/executable&gt; &lt;arguments&gt; &lt;argument&gt;-classpath&lt;/argument&gt; &lt;!-- automatically creates the classpath using all project dependencies, also adding the project build directory --&gt; &lt;classpath/&gt; &lt;argument&gt;com.github.hoffmanzheng.springboot.Application&lt;/argument&gt; &lt;/arguments&gt; &lt;/configuration&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;/plugin&gt; mvn exec:exec@[executionID] 即可完成程序的部署；-X 参数可以用于排查部署时出现的问题，-DskipTests 可以跳过测试。 windosw下（需使用系统 cmd） netstat -ano | findstr &#34;8080&#34; 可以查看当前端口被占用的情况，tasklist |findstr &#34;进程id号&#34; 查找对应的进程名称，然后 taskkill /f /t /im &#34;进程id或者进程名称&#34; 杀掉当前占用端口的进程 部署效果图：">
  <meta itemprop="datePublished" content="2020-04-21T11:30:47+01:00">
  <meta itemprop="dateModified" content="2020-04-21T11:30:47+01:00">
  <meta itemprop="wordCount" content="302">
  <meta itemprop="keywords" content="Java"><meta property="og:url" content="https://hoffmanzheng.github.io/2020/deploy/">
  <meta property="og:site_name" content="人间一场大梦">
  <meta property="og:title" content="Java：程序的部署和 Nginx 负载均衡">
  <meta property="og:description" content="本篇介绍 Java 程序部署的三种方式：exec 插件、jar 包、Docker 方式部署，以及使用 Nginx 实现简单的负载均衡。
Java 程序的部署 Maven exec 插件部署 导入 Maven 的 exec 插件：Maven Repository：exec-maven-plugin，然后在 pom.xml 中进行配置，使之可以调用外部命令执行 Java 程序并自动加载依赖的 classpath 路径： &lt;plugin&gt; &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt; &lt;artifactId&gt;exec-maven-plugin&lt;/artifactId&gt; &lt;version&gt;1.6.0&lt;/version&gt; &lt;executions&gt; &lt;execution&gt; &lt;id&gt;run&lt;/id&gt; &lt;goals&gt; &lt;goal&gt;exec&lt;/goal&gt; &lt;/goals&gt; &lt;configuration&gt; &lt;executable&gt;java&lt;/executable&gt; &lt;arguments&gt; &lt;argument&gt;-classpath&lt;/argument&gt; &lt;!-- automatically creates the classpath using all project dependencies, also adding the project build directory --&gt; &lt;classpath/&gt; &lt;argument&gt;com.github.hoffmanzheng.springboot.Application&lt;/argument&gt; &lt;/arguments&gt; &lt;/configuration&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;/plugin&gt; mvn exec:exec@[executionID] 即可完成程序的部署；-X 参数可以用于排查部署时出现的问题，-DskipTests 可以跳过测试。 windosw下（需使用系统 cmd） netstat -ano | findstr &#34;8080&#34; 可以查看当前端口被占用的情况，tasklist |findstr &#34;进程id号&#34; 查找对应的进程名称，然后 taskkill /f /t /im &#34;进程id或者进程名称&#34; 杀掉当前占用端口的进程 部署效果图：">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2020-04-21T11:30:47+01:00">
    <meta property="article:modified_time" content="2020-04-21T11:30:47+01:00">
    <meta property="article:tag" content="Java">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Java：程序的部署和 Nginx 负载均衡">
  <meta name="twitter:description" content="本篇介绍 Java 程序部署的三种方式：exec 插件、jar 包、Docker 方式部署，以及使用 Nginx 实现简单的负载均衡。
Java 程序的部署 Maven exec 插件部署 导入 Maven 的 exec 插件：Maven Repository：exec-maven-plugin，然后在 pom.xml 中进行配置，使之可以调用外部命令执行 Java 程序并自动加载依赖的 classpath 路径： &lt;plugin&gt; &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt; &lt;artifactId&gt;exec-maven-plugin&lt;/artifactId&gt; &lt;version&gt;1.6.0&lt;/version&gt; &lt;executions&gt; &lt;execution&gt; &lt;id&gt;run&lt;/id&gt; &lt;goals&gt; &lt;goal&gt;exec&lt;/goal&gt; &lt;/goals&gt; &lt;configuration&gt; &lt;executable&gt;java&lt;/executable&gt; &lt;arguments&gt; &lt;argument&gt;-classpath&lt;/argument&gt; &lt;!-- automatically creates the classpath using all project dependencies, also adding the project build directory --&gt; &lt;classpath/&gt; &lt;argument&gt;com.github.hoffmanzheng.springboot.Application&lt;/argument&gt; &lt;/arguments&gt; &lt;/configuration&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;/plugin&gt; mvn exec:exec@[executionID] 即可完成程序的部署；-X 参数可以用于排查部署时出现的问题，-DskipTests 可以跳过测试。 windosw下（需使用系统 cmd） netstat -ano | findstr &#34;8080&#34; 可以查看当前端口被占用的情况，tasklist |findstr &#34;进程id号&#34; 查找对应的进程名称，然后 taskkill /f /t /im &#34;进程id或者进程名称&#34; 杀掉当前占用端口的进程 部署效果图：">
<meta name="application-name" content="FixIt">
<meta name="apple-mobile-web-app-title" content="FixIt"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" type="text/html" href="https://hoffmanzheng.github.io/2020/deploy/" title="Java：程序的部署和 Nginx 负载均衡 - 人间一场大梦" /><link rel="prev" type="text/html" href="https://hoffmanzheng.github.io/2020/java-threadpool/" title="Java：线程池原理、源码分析" /><link rel="next" type="text/html" href="https://hoffmanzheng.github.io/2020/dns-cdn/" title="深入 Web 请求过程" /><link rel="stylesheet" href="/css/config.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "Java：程序的部署和 Nginx 负载均衡",
    "inLanguage": "en-us",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https:\/\/hoffmanzheng.github.io\/2020\/deploy\/"
    },"genre": "posts","keywords": "Java","wordcount":  302 ,
    "url": "https:\/\/hoffmanzheng.github.io\/2020\/deploy\/","datePublished": "2020-04-21T11:30:47+01:00","dateModified": "2020-04-21T11:30:47+01:00","publisher": {
      "@type": "Organization",
      "name": ""},"author": {
        "@type": "Person",
        "name": "Chenghao Zheng"
      },"description": ""
  }
  </script><script src="/js/head/color-scheme.min.js"></script></head>
  <body data-instant-intensity="viewport" data-header-desktop="sticky" data-header-mobile="auto"><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="人间一场大梦"><span class="header-title-text">人间一场大梦</span></a><span class="header-subtitle"></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a class="menu-link" href="/posts/">Blog</a></li><li class="menu-item">
              <a class="menu-link" href="/categories/">Categories</a></li><li class="menu-item">
              <a class="menu-link" href="/tags/">Tags</a></li><li class="menu-item">
              <a class="menu-link" href="/about/">About</a></li><li class="menu-item delimiter"></li><li class="menu-item theme-switch" role="button" aria-label="Switch Theme" title="Switch Theme"><i class="fa-solid fa-adjust" aria-hidden="true"></i></li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="人间一场大梦"><span class="header-title-text">人间一场大梦</span></a><span class="header-subtitle"></span></div>
      <div class="theme-switch" role="button" aria-label="Switch Theme"><i class="fa-solid fa-adjust" aria-hidden="true"></i></div>
      <div class="menu-toggle" id="menu-toggle-mobile" role="button" aria-labelledby="menu-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="menu-item"><a class="menu-link" href="/posts/">Blog</a></li><li class="menu-item"><a class="menu-link" href="/categories/">Categories</a></li><li class="menu-item"><a class="menu-link" href="/tags/">Tags</a></li><li class="menu-item"><a class="menu-link" href="/about/">About</a></li><li class="menu-item menu-system"></li>
      </ul>
    </nav>
  </div>
</header><main class="fi-container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="Collections"></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span>Java：程序的部署和 Nginx 负载均衡</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><span class="author"><i class="fa-solid fa-user-circle" aria-hidden="true"></i>
      Chenghao Zheng</span></span><span class="post-included-in">&nbsp;included in <a href="/categories/study-notes/" class="post-category" title="Category - Study Notes"><i class="fa-regular fa-folder" aria-hidden="true"></i> Study Notes</a></span></div><div class="post-meta-line"><span title="published on 2020-04-21 11:30:47"><i class="fa-solid fa-calendar-days me-1" aria-hidden="true"></i><time datetime="2020-04-21">2020-04-21</time></span>&nbsp;<span title="302 words"><i class="fa-solid fa-pencil-alt me-1" aria-hidden="true"></i>About 400 words</span>&nbsp;<span><i class="fa-regular fa-clock me-1" aria-hidden="true"></i>2 minutes</span>&nbsp;</div>
    </div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>Contents</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#maven-exec-插件部署">Maven exec 插件部署</a></li>
        <li><a href="#jar-包形式部署">Jar 包形式部署</a></li>
        <li><a href="#用-docker-部署">用 Docker 部署</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#负载均衡简介">负载均衡简介</a></li>
        <li><a href="#负载均衡配置">负载均衡配置</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
      </div><div class="content" id="content"><p>本篇介绍 Java 程序部署的三种方式：exec 插件、jar 包、Docker 方式部署，以及使用 Nginx 实现简单的负载均衡。</p>
<h1 class="heading-element" id="java-程序的部署"><span>Java 程序的部署</span>
  <a href="#java-%e7%a8%8b%e5%ba%8f%e7%9a%84%e9%83%a8%e7%bd%b2" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h1><h3 class="heading-element" id="maven-exec-插件部署"><span>Maven exec 插件部署</span>
  <a href="#maven-exec-%e6%8f%92%e4%bb%b6%e9%83%a8%e7%bd%b2" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ol>
<li>导入 Maven 的 exec 插件：<a href="https://mvnrepository.com/artifact/org.codehaus.mojo/exec-maven-plugin" target="_blank" rel="external nofollow noopener noreferrer">Maven Repository：exec-maven-plugin</a>，然后在 pom.xml 中进行配置，使之可以调用外部命令执行 Java 程序并自动加载依赖的 classpath 路径：</li>
</ol>
<div class="code-block highlight line-nos-hidden" data-mode="classic" data-copyable="true"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">plugin</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">groupId</span>&gt;org.codehaus.mojo&lt;/<span style="color:#f92672">groupId</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">artifactId</span>&gt;exec-maven-plugin&lt;/<span style="color:#f92672">artifactId</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">version</span>&gt;1.6.0&lt;/<span style="color:#f92672">version</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">executions</span>&gt;
</span></span><span style="display:flex;"><span>	&lt;<span style="color:#f92672">execution</span>&gt;
</span></span><span style="display:flex;"><span>		&lt;<span style="color:#f92672">id</span>&gt;run&lt;/<span style="color:#f92672">id</span>&gt;
</span></span><span style="display:flex;"><span>		&lt;<span style="color:#f92672">goals</span>&gt;
</span></span><span style="display:flex;"><span>			&lt;<span style="color:#f92672">goal</span>&gt;exec&lt;/<span style="color:#f92672">goal</span>&gt;
</span></span><span style="display:flex;"><span>		&lt;/<span style="color:#f92672">goals</span>&gt;
</span></span><span style="display:flex;"><span>		&lt;<span style="color:#f92672">configuration</span>&gt;
</span></span><span style="display:flex;"><span>			&lt;<span style="color:#f92672">executable</span>&gt;java&lt;/<span style="color:#f92672">executable</span>&gt;
</span></span><span style="display:flex;"><span>			&lt;<span style="color:#f92672">arguments</span>&gt;
</span></span><span style="display:flex;"><span>				&lt;<span style="color:#f92672">argument</span>&gt;-classpath&lt;/<span style="color:#f92672">argument</span>&gt;
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">&lt;!-- automatically creates the classpath using all project dependencies,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">          also adding the project build directory --&gt;</span>
</span></span><span style="display:flex;"><span>				&lt;<span style="color:#f92672">classpath</span>/&gt;
</span></span><span style="display:flex;"><span>				&lt;<span style="color:#f92672">argument</span>&gt;com.github.hoffmanzheng.springboot.Application&lt;/<span style="color:#f92672">argument</span>&gt;
</span></span><span style="display:flex;"><span>			&lt;/<span style="color:#f92672">arguments</span>&gt;
</span></span><span style="display:flex;"><span>		&lt;/<span style="color:#f92672">configuration</span>&gt;
</span></span><span style="display:flex;"><span>	&lt;/<span style="color:#f92672">execution</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">executions</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">plugin</span>&gt;</span></span></code></pre></div><ol start="2">
<li><code>mvn exec:exec@[executionID]</code> 即可完成程序的部署；<code>-X</code> 参数可以用于排查部署时出现的问题，<code>-DskipTests</code>  可以跳过测试。</li>
<li>windosw下（需使用系统 cmd） <code>netstat -ano | findstr &quot;8080&quot;</code> 可以查看当前端口被占用的情况，<code>tasklist |findstr &quot;进程id号&quot;</code>  查找对应的进程名称，然后 <code>taskkill /f /t /im &quot;进程id或者进程名称&quot;</code> 杀掉当前占用端口的进程</li>
</ol>
<p>部署效果图：</p>
<p><img loading="lazy" src='/images/exec部署.png' alt="/images/exec部署.png"></p>
<h3 class="heading-element" id="jar-包形式部署"><span>Jar 包形式部署</span>
  <a href="#jar-%e5%8c%85%e5%bd%a2%e5%bc%8f%e9%83%a8%e7%bd%b2" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ol>
<li>使用 <code>mvn package -DskipTests</code> 把项目打包</li>
<li>用命令行参数改变默认的 Spring 端口：<code>java -jar ./target/Multiplayer-Online-Blog-Platform-0.0.1-SNAPSHOT.jar --server.port=8081</code></li>
<li>war 包与 jar 包的区别是没有内嵌 Tomcat 容器，无法直接运行，需要将 war 包放置在 Servlet 容器中才能运行。</li>
</ol>
<h3 class="heading-element" id="用-docker-部署"><span>用 Docker 部署</span>
  <a href="#%e7%94%a8-docker-%e9%83%a8%e7%bd%b2" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ol>
<li>编写 Dockerfile 将之前打的 jar 包放进去，对外暴露 8080 端口。</li>
</ol>
<div class="code-block highlight line-nos-hidden" data-mode="classic" data-copyable="true"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> <span style="color:#e6db74">java:openjdk-8u111-alpine</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#66d9ef">RUN</span> mkdir /app<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#66d9ef">WORKDIR</span> <span style="color:#e6db74">/app</span>       //工作目录<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#66d9ef">COPY</span> target/Multiplayer-Online-Blog-Platform-0.0.1-SNAPSHOT.jar /app<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#66d9ef">EXPOSE</span> <span style="color:#e6db74">8080</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#66d9ef">CMD</span> [<span style="color:#e6db74">&#34;java&#34;</span>,<span style="color:#e6db74">&#34;-jar&#34;</span>,<span style="color:#e6db74">&#34;Multiplayer-Online-Blog-Platform-0.0.1-SNAPSHOT.jar&#34;</span>]</span></span></code></pre></div><ol start="2">
<li>
<p>构建一个 Docker 镜像：<code>docker build .</code> 随后可以用 <code>docker tag [imageID] [imageName]:tag</code> 来修改生成镜像的名字和版本</p>
</li>
<li>
<p>启动容器：<code>docker run --name blog-launch8082 -p 8082:8080 -v d://application.properties:/app/config/application.properties blog-launch:1.1</code></p>
</li>
<li>
<p>由于 Docker 容器内外环境完全隔离，这就导致容器内的 Java 程序无法正常连接数据库，需要通过 -v 参数将外部的  application.properties（数据库连接的 URL 中的 localhost 改为当前局域网的 IP） 映射到容器内工作目录的 /config 下。</p>
<p>参考：<a href="https://docs.spring.io/spring-boot/docs/1.2.2.RELEASE/reference/html/boot-features-external-config.html" target="_blank" rel="external nofollow noopener noreferrer">Spring Boot features：Externalized Configuration</a></p>
</li>
<li>
<p><code>docker exec -it [containerID] bash</code> 可以进到容器内部排查问题</p>
</li>
</ol>
<h1 class="heading-element" id="nginx-实现负载均衡"><span>Nginx 实现负载均衡</span>
  <a href="#nginx-%e5%ae%9e%e7%8e%b0%e8%b4%9f%e8%bd%bd%e5%9d%87%e8%a1%a1" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h1><h3 class="heading-element" id="负载均衡简介"><span>负载均衡简介</span>
  <a href="#%e8%b4%9f%e8%bd%bd%e5%9d%87%e8%a1%a1%e7%ae%80%e4%bb%8b" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>
<p>负载均衡 Load balancing 是一种水平扩展的分布式解决方案，它可以将高并发的用户流量分摊到多个应用程序服务器上，以缓解单个服务器的流量压力，改善 Web 应用程序的性能，并且可以有效避免单点故障和容灾事故。</p>
</li>
<li>
<p>Nginx 文档中提及的三种负载均衡机制：</p>
</li>
</ul>
<blockquote>
<p>round-robin — requests to the application servers are distributed in a round-robin fashion,</p>
<p>least-connected — next request is assigned to the server with the least number of active connections,</p>
<p>ip-hash — a hash-function is used to determine what server should be selected for the next request (based on the client’s IP address).</p>
</blockquote>
<h3 class="heading-element" id="负载均衡配置"><span>负载均衡配置</span>
  <a href="#%e8%b4%9f%e8%bd%bd%e5%9d%87%e8%a1%a1%e9%85%8d%e7%bd%ae" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>
<p>从 Docker 启动 Nginx：<code>docker run -d --name blog-nginx --restart=always -v d://nginx/nginx.conf:/etc/nginx/nginx.conf -p 80:80 nginx:1.17.10</code></p>
</li>
<li>
<p>在宿主机上配置好 nginx.conf 然后映射到 Docker 容器内部：</p>
</li>
</ul>
<div class="code-block highlight line-nos-hidden" data-mode="classic" data-copyable="true"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>events <span style="color:#f92672">{</span> <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>http <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    upstream myapp1 <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        server 192.168.217.65:8080;   // 本地局域网
</span></span><span style="display:flex;"><span>        server 192.168.217.65:8081;
</span></span><span style="display:flex;"><span>        server 192.168.217.65:8082;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    server <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        listen 80;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        location / <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            proxy_pass http://myapp1;
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span></span></span></code></pre></div><ul>
<li>
<p>出问题后，可以打印日志 <code>docker logs [containerID]</code>，也可以进到 Nginx 容器内部进行排查：<code>docker exec -it ID bash</code>，测试下网络连通性等。</p>
</li>
<li>
<p>最后的效果图：</p>
</li>
</ul>
<p><img loading="lazy" src='/images/负载均衡.png' alt="/images/负载均衡.png"></p>
</div><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod"><span title="Updated on 2020-04-21 11:30:47">Updated on 2020-04-21&nbsp;</span>
      </div><div class="post-info-license">
            <span><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a></span>
          </div></div><div class="post-info-line">
        <div class="post-info-md"></div>
        <div class="post-info-share">
          <span><a href="javascript:void(0);" title="Share on X" data-sharer="twitter" data-url="https://hoffmanzheng.github.io/2020/deploy/" data-title="Java：程序的部署和 Nginx 负载均衡" data-hashtags="Java"><i class="fa-brands fa-x-twitter" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://hoffmanzheng.github.io/2020/deploy/" data-hashtag="Java"><i class="fa-brands fa-facebook-square" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="https://hoffmanzheng.github.io/2020/deploy/" data-title="Java：程序的部署和 Nginx 负载均衡"><i class="fa-brands fa-weibo" aria-hidden="true"></i></a>
  </span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags me-1" aria-hidden="true"></i><a href="/tags/java/" class="post-tag" title="Tags - Java">Java</a></section>
    <section><span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
    </section>
  </div><div class="post-nav"><a href="/2020/java-threadpool/" class="post-nav-item" rel="prev" title="Java：线程池原理、源码分析"><i class="fa-solid fa-angle-left" aria-hidden="true"></i>Java：线程池原理、源码分析</a><a href="/2020/dns-cdn/" class="post-nav-item" rel="next" title="深入 Web 请求过程">深入 Web 请求过程<i class="fa-solid fa-angle-right" aria-hidden="true"></i></a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="Contents"><h2 class="toc-title">Contents&nbsp;<i class="toc-icon fa-solid fa-angle-down" aria-hidden="true"></i></h2>
      <div class="toc-content" id="toc-content-auto"></div></aside><dialog id="toc-dialog" aria-labelledby="toc-dialog-title" role="dialog">
      <div class="toc">
        <h2 class="toc-title">Contents</h2>
        <div class="toc-content" id="toc-content-drawer"><nav >
  <ul>
    <li>
      <ul>
        <li><a href="#maven-exec-插件部署">Maven exec 插件部署</a></li>
        <li><a href="#jar-包形式部署">Jar 包形式部署</a></li>
        <li><a href="#用-docker-部署">用 Docker 部署</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#负载均衡简介">负载均衡简介</a></li>
        <li><a href="#负载均衡配置">负载均衡配置</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
      </div>
    </dialog></main><footer class="footer">
    <div class="footer-container"><div class="footer-line powered">Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreferrer" title="Hugo 0.156.0"><img class="hugo-icon" src="/images/hugo.min.svg" alt="Hugo logo" /> Hugo</a> | Theme - <a href="https://github.com/hugo-fixit/FixIt" target="_blank" rel="external" title="FixIt v0.4.3-20260130042349-e23a50d7"><img class="fixit-icon" src="/images/fixit.min.svg" alt="FixIt logo" /> FixIt</a>
        </div><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2026</span><span class="author" itemprop="copyrightHolder">
              <a href="/"></a></span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons"><div class="fixed-button back-to-top animate__faster d-none" role="button" aria-label="Back to Top"><i class="fa-solid fa-arrow-up" aria-hidden="true"></i></div><div id="toc-drawer-button" class="fixed-button toc-drawer-button d-none" role="button" aria-label="Contents"><i class="fa-solid fa-bars" aria-hidden="true"></i></div></div><div id="mask"></div><noscript>
    <div class="noscript-warning">This website works best with JavaScript enabled.</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script src="/lib/sharer/sharer.min.js" async defer></script><script src="/lib/cookieconsent/cookieconsent.min.js" defer></script><script src="/js/config/29cb3213422d0d115a815f4e6dad7f25.js" defer></script><script src="/js/theme.min.js" defer></script></body>
</html>
